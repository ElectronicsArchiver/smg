.text

.include "macros.inc"

.global __fwrite
__fwrite:
/* 80519DAC 005152EC  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 80519DB0 005152F0  7C 08 02 A6 */	mflr r0
/* 80519DB4 005152F4  90 01 00 34 */	stw r0, 0x34(r1)
/* 80519DB8 005152F8  BF 21 00 14 */	stmw r25, 0x14(r1)
/* 80519DBC 005152FC  7C 9B 23 78 */	mr r27, r4
/* 80519DC0 00515300  7C DC 33 78 */	mr r28, r6
/* 80519DC4 00515304  7C 7A 1B 78 */	mr r26, r3
/* 80519DC8 00515308  7C B9 2B 78 */	mr r25, r5
/* 80519DCC 0051530C  38 80 00 00 */	li r4, 0
/* 80519DD0 00515310  7F 83 E3 78 */	mr r3, r28
/* 80519DD4 00515314  48 00 8E 41 */	bl fwide
/* 80519DD8 00515318  2C 03 00 00 */	cmpwi r3, 0
/* 80519DDC 0051531C  40 82 00 10 */	bne lbl_80519DEC
/* 80519DE0 00515320  7F 83 E3 78 */	mr r3, r28
/* 80519DE4 00515324  38 80 FF FF */	li r4, -1
/* 80519DE8 00515328  48 00 8E 2D */	bl fwide
lbl_80519DEC:
/* 80519DEC 0051532C  7F DB C9 D7 */	mullw. r30, r27, r25
/* 80519DF0 00515330  41 82 00 1C */	beq lbl_80519E0C
/* 80519DF4 00515334  88 1C 00 0A */	lbz r0, 0xa(r28)
/* 80519DF8 00515338  2C 00 00 00 */	cmpwi r0, 0
/* 80519DFC 0051533C  40 82 00 10 */	bne lbl_80519E0C
/* 80519E00 00515340  80 1C 00 04 */	lwz r0, 4(r28)
/* 80519E04 00515344  54 00 57 7F */	rlwinm. r0, r0, 0xa, 0x1d, 0x1f
/* 80519E08 00515348  40 82 00 0C */	bne lbl_80519E14
lbl_80519E0C:
/* 80519E0C 0051534C  38 60 00 00 */	li r3, 0
/* 80519E10 00515350  48 00 02 90 */	b lbl_8051A0A0
lbl_80519E14:
/* 80519E14 00515354  28 00 00 02 */	cmplwi r0, 2
/* 80519E18 00515358  40 82 00 08 */	bne lbl_80519E20
/* 80519E1C 0051535C  48 00 0E 2D */	bl __stdio_atexit
lbl_80519E20:
/* 80519E20 00515360  80 7C 00 04 */	lwz r3, 4(r28)
/* 80519E24 00515364  3B E0 00 01 */	li r31, 1
/* 80519E28 00515368  38 80 00 00 */	li r4, 0
/* 80519E2C 0051536C  54 60 6F FF */	rlwinm. r0, r3, 0xd, 0x1f, 0x1f
/* 80519E30 00515370  41 82 00 10 */	beq lbl_80519E40
/* 80519E34 00515374  54 60 3F BE */	rlwinm r0, r3, 7, 0x1e, 0x1f
/* 80519E38 00515378  28 00 00 02 */	cmplwi r0, 2
/* 80519E3C 0051537C  40 82 00 08 */	bne lbl_80519E44
lbl_80519E40:
/* 80519E40 00515380  38 80 00 01 */	li r4, 1
lbl_80519E44:
/* 80519E44 00515384  2C 04 00 00 */	cmpwi r4, 0
/* 80519E48 00515388  40 82 00 18 */	bne lbl_80519E60
/* 80519E4C 0051538C  80 1C 00 04 */	lwz r0, 4(r28)
/* 80519E50 00515390  54 00 3F BE */	rlwinm r0, r0, 7, 0x1e, 0x1f
/* 80519E54 00515394  28 00 00 01 */	cmplwi r0, 1
/* 80519E58 00515398  41 82 00 08 */	beq lbl_80519E60
/* 80519E5C 0051539C  3B E0 00 00 */	li r31, 0
lbl_80519E60:
/* 80519E60 005153A0  80 1C 00 08 */	lwz r0, 8(r28)
/* 80519E64 005153A4  54 00 1F 7F */	rlwinm. r0, r0, 3, 0x1d, 0x1f
/* 80519E68 005153A8  40 82 00 54 */	bne lbl_80519EBC
/* 80519E6C 005153AC  80 7C 00 04 */	lwz r3, 4(r28)
/* 80519E70 005153B0  54 60 2F BD */	rlwinm. r0, r3, 5, 0x1e, 0x1e
/* 80519E74 005153B4  54 60 2F 7E */	rlwinm r0, r3, 5, 0x1d, 0x1f
/* 80519E78 005153B8  41 82 00 44 */	beq lbl_80519EBC
/* 80519E7C 005153BC  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 80519E80 005153C0  41 82 00 24 */	beq lbl_80519EA4
/* 80519E84 005153C4  7F 83 E3 78 */	mr r3, r28
/* 80519E88 005153C8  38 80 00 00 */	li r4, 0
/* 80519E8C 005153CC  38 A0 00 02 */	li r5, 2
/* 80519E90 005153D0  48 00 04 C1 */	bl _fseek
/* 80519E94 005153D4  2C 03 00 00 */	cmpwi r3, 0
/* 80519E98 005153D8  41 82 00 0C */	beq lbl_80519EA4
/* 80519E9C 005153DC  38 60 00 00 */	li r3, 0
/* 80519EA0 005153E0  48 00 02 00 */	b lbl_8051A0A0
lbl_80519EA4:
/* 80519EA4 005153E4  80 1C 00 08 */	lwz r0, 8(r28)
/* 80519EA8 005153E8  38 60 00 01 */	li r3, 1
/* 80519EAC 005153EC  50 60 E8 04 */	rlwimi r0, r3, 0x1d, 0, 2
/* 80519EB0 005153F0  90 1C 00 08 */	stw r0, 8(r28)
/* 80519EB4 005153F4  7F 83 E3 78 */	mr r3, r28
/* 80519EB8 005153F8  4B FF FD DD */	bl __prep_buffer
lbl_80519EBC:
/* 80519EBC 005153FC  80 1C 00 08 */	lwz r0, 8(r28)
/* 80519EC0 00515400  54 00 1F 7E */	srwi r0, r0, 0x1d
/* 80519EC4 00515404  28 00 00 01 */	cmplwi r0, 1
/* 80519EC8 00515408  41 82 00 1C */	beq lbl_80519EE4
/* 80519ECC 0051540C  38 60 00 01 */	li r3, 1
/* 80519ED0 00515410  38 00 00 00 */	li r0, 0
/* 80519ED4 00515414  98 7C 00 0A */	stb r3, 0xa(r28)
/* 80519ED8 00515418  38 60 00 00 */	li r3, 0
/* 80519EDC 0051541C  90 1C 00 28 */	stw r0, 0x28(r28)
/* 80519EE0 00515420  48 00 01 C0 */	b lbl_8051A0A0
lbl_80519EE4:
/* 80519EE4 00515424  2C 1E 00 00 */	cmpwi r30, 0
/* 80519EE8 00515428  3B A0 00 00 */	li r29, 0
/* 80519EEC 0051542C  41 82 01 28 */	beq lbl_8051A014
/* 80519EF0 00515430  80 7C 00 1C */	lwz r3, 0x1c(r28)
/* 80519EF4 00515434  80 9C 00 24 */	lwz r4, 0x24(r28)
/* 80519EF8 00515438  7C 04 18 40 */	cmplw r4, r3
/* 80519EFC 0051543C  40 82 00 0C */	bne lbl_80519F08
/* 80519F00 00515440  2C 1F 00 00 */	cmpwi r31, 0
/* 80519F04 00515444  41 82 01 10 */	beq lbl_8051A014
lbl_80519F08:
/* 80519F08 00515448  80 1C 00 20 */	lwz r0, 0x20(r28)
/* 80519F0C 0051544C  7C 63 20 50 */	subf r3, r3, r4
/* 80519F10 00515450  7C 03 00 50 */	subf r0, r3, r0
/* 80519F14 00515454  90 1C 00 28 */	stw r0, 0x28(r28)
lbl_80519F18:
/* 80519F18 00515458  80 BC 00 28 */	lwz r5, 0x28(r28)
/* 80519F1C 0051545C  3B 20 00 00 */	li r25, 0
/* 80519F20 00515460  7C 05 F0 40 */	cmplw r5, r30
/* 80519F24 00515464  90 A1 00 08 */	stw r5, 8(r1)
/* 80519F28 00515468  40 81 00 0C */	ble lbl_80519F34
/* 80519F2C 0051546C  7F C5 F3 78 */	mr r5, r30
/* 80519F30 00515470  93 C1 00 08 */	stw r30, 8(r1)
lbl_80519F34:
/* 80519F34 00515474  80 1C 00 04 */	lwz r0, 4(r28)
/* 80519F38 00515478  54 00 3F BE */	rlwinm r0, r0, 7, 0x1e, 0x1f
/* 80519F3C 0051547C  28 00 00 01 */	cmplwi r0, 1
/* 80519F40 00515480  40 82 00 30 */	bne lbl_80519F70
/* 80519F44 00515484  2C 05 00 00 */	cmpwi r5, 0
/* 80519F48 00515488  41 82 00 28 */	beq lbl_80519F70
/* 80519F4C 0051548C  7F 43 D3 78 */	mr r3, r26
/* 80519F50 00515490  38 80 00 0A */	li r4, 0xa
/* 80519F54 00515494  48 00 08 B1 */	bl __memrchr
/* 80519F58 00515498  2C 03 00 00 */	cmpwi r3, 0
/* 80519F5C 0051549C  7C 79 1B 78 */	mr r25, r3
/* 80519F60 005154A0  41 82 00 10 */	beq lbl_80519F70
/* 80519F64 005154A4  38 03 00 01 */	addi r0, r3, 1
/* 80519F68 005154A8  7C BA 00 50 */	subf r5, r26, r0
/* 80519F6C 005154AC  90 A1 00 08 */	stw r5, 8(r1)
lbl_80519F70:
/* 80519F70 005154B0  80 A1 00 08 */	lwz r5, 8(r1)
/* 80519F74 005154B4  2C 05 00 00 */	cmpwi r5, 0
/* 80519F78 005154B8  41 82 00 38 */	beq lbl_80519FB0
/* 80519F7C 005154BC  80 7C 00 24 */	lwz r3, 0x24(r28)
/* 80519F80 005154C0  7F 44 D3 78 */	mr r4, r26
/* 80519F84 005154C4  4B AE A3 B5 */	bl memcpy
/* 80519F88 005154C8  80 81 00 08 */	lwz r4, 8(r1)
/* 80519F8C 005154CC  80 7C 00 24 */	lwz r3, 0x24(r28)
/* 80519F90 005154D0  80 1C 00 28 */	lwz r0, 0x28(r28)
/* 80519F94 005154D4  7F 5A 22 14 */	add r26, r26, r4
/* 80519F98 005154D8  7C 63 22 14 */	add r3, r3, r4
/* 80519F9C 005154DC  7F C4 F0 50 */	subf r30, r4, r30
/* 80519FA0 005154E0  90 7C 00 24 */	stw r3, 0x24(r28)
/* 80519FA4 005154E4  80 61 00 08 */	lwz r3, 8(r1)
/* 80519FA8 005154E8  7C 03 00 50 */	subf r0, r3, r0
/* 80519FAC 005154EC  90 1C 00 28 */	stw r0, 0x28(r28)
lbl_80519FB0:
/* 80519FB0 005154F0  80 1C 00 28 */	lwz r0, 0x28(r28)
/* 80519FB4 005154F4  2C 00 00 00 */	cmpwi r0, 0
/* 80519FB8 005154F8  41 82 00 18 */	beq lbl_80519FD0
/* 80519FBC 005154FC  2C 19 00 00 */	cmpwi r25, 0
/* 80519FC0 00515500  40 82 00 10 */	bne lbl_80519FD0
/* 80519FC4 00515504  80 1C 00 04 */	lwz r0, 4(r28)
/* 80519FC8 00515508  54 00 3F BF */	rlwinm. r0, r0, 7, 0x1e, 0x1f
/* 80519FCC 0051550C  40 82 00 30 */	bne lbl_80519FFC
lbl_80519FD0:
/* 80519FD0 00515510  7F 83 E3 78 */	mr r3, r28
/* 80519FD4 00515514  38 80 00 00 */	li r4, 0
/* 80519FD8 00515518  4B FF FC E5 */	bl __flush_buffer
/* 80519FDC 0051551C  2C 03 00 00 */	cmpwi r3, 0
/* 80519FE0 00515520  41 82 00 1C */	beq lbl_80519FFC
/* 80519FE4 00515524  38 60 00 01 */	li r3, 1
/* 80519FE8 00515528  38 00 00 00 */	li r0, 0
/* 80519FEC 0051552C  98 7C 00 0A */	stb r3, 0xa(r28)
/* 80519FF0 00515530  3B C0 00 00 */	li r30, 0
/* 80519FF4 00515534  90 1C 00 28 */	stw r0, 0x28(r28)
/* 80519FF8 00515538  48 00 00 1C */	b lbl_8051A014
lbl_80519FFC:
/* 80519FFC 0051553C  80 01 00 08 */	lwz r0, 8(r1)
/* 8051A000 00515540  2C 1E 00 00 */	cmpwi r30, 0
/* 8051A004 00515544  7F BD 02 14 */	add r29, r29, r0
/* 8051A008 00515548  41 82 00 0C */	beq lbl_8051A014
/* 8051A00C 0051554C  2C 1F 00 00 */	cmpwi r31, 0
/* 8051A010 00515550  40 82 FF 08 */	bne lbl_80519F18
lbl_8051A014:
/* 8051A014 00515554  2C 1E 00 00 */	cmpwi r30, 0
/* 8051A018 00515558  41 82 00 6C */	beq lbl_8051A084
/* 8051A01C 0051555C  2C 1F 00 00 */	cmpwi r31, 0
/* 8051A020 00515560  40 82 00 64 */	bne lbl_8051A084
/* 8051A024 00515564  83 3C 00 1C */	lwz r25, 0x1c(r28)
/* 8051A028 00515568  7C 1A F2 14 */	add r0, r26, r30
/* 8051A02C 0051556C  83 FC 00 20 */	lwz r31, 0x20(r28)
/* 8051A030 00515570  7F 83 E3 78 */	mr r3, r28
/* 8051A034 00515574  93 5C 00 1C */	stw r26, 0x1c(r28)
/* 8051A038 00515578  38 81 00 08 */	addi r4, r1, 8
/* 8051A03C 0051557C  93 DC 00 20 */	stw r30, 0x20(r28)
/* 8051A040 00515580  90 1C 00 24 */	stw r0, 0x24(r28)
/* 8051A044 00515584  4B FF FC 79 */	bl __flush_buffer
/* 8051A048 00515588  2C 03 00 00 */	cmpwi r3, 0
/* 8051A04C 0051558C  41 82 00 18 */	beq lbl_8051A064
/* 8051A050 00515590  38 60 00 01 */	li r3, 1
/* 8051A054 00515594  38 00 00 00 */	li r0, 0
/* 8051A058 00515598  98 7C 00 0A */	stb r3, 0xa(r28)
/* 8051A05C 0051559C  90 1C 00 28 */	stw r0, 0x28(r28)
/* 8051A060 005155A0  48 00 00 0C */	b lbl_8051A06C
lbl_8051A064:
/* 8051A064 005155A4  80 01 00 08 */	lwz r0, 8(r1)
/* 8051A068 005155A8  7F BD 02 14 */	add r29, r29, r0
lbl_8051A06C:
/* 8051A06C 005155AC  93 3C 00 1C */	stw r25, 0x1c(r28)
/* 8051A070 005155B0  7F 83 E3 78 */	mr r3, r28
/* 8051A074 005155B4  93 FC 00 20 */	stw r31, 0x20(r28)
/* 8051A078 005155B8  4B FF FC 1D */	bl __prep_buffer
/* 8051A07C 005155BC  38 00 00 00 */	li r0, 0
/* 8051A080 005155C0  90 1C 00 28 */	stw r0, 0x28(r28)
lbl_8051A084:
/* 8051A084 005155C4  80 1C 00 04 */	lwz r0, 4(r28)
/* 8051A088 005155C8  54 00 3F BE */	rlwinm r0, r0, 7, 0x1e, 0x1f
/* 8051A08C 005155CC  28 00 00 02 */	cmplwi r0, 2
/* 8051A090 005155D0  41 82 00 0C */	beq lbl_8051A09C
/* 8051A094 005155D4  38 00 00 00 */	li r0, 0
/* 8051A098 005155D8  90 1C 00 28 */	stw r0, 0x28(r28)
lbl_8051A09C:
/* 8051A09C 005155DC  7C 7D DB 96 */	divwu r3, r29, r27
lbl_8051A0A0:
/* 8051A0A0 005155E0  BB 21 00 14 */	lmw r25, 0x14(r1)
/* 8051A0A4 005155E4  80 01 00 34 */	lwz r0, 0x34(r1)
/* 8051A0A8 005155E8  7C 08 03 A6 */	mtlr r0
/* 8051A0AC 005155EC  38 21 00 30 */	addi r1, r1, 0x30
/* 8051A0B0 005155F0  4E 80 00 20 */	blr 
